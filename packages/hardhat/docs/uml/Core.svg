<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: UmlClassDiagram Pages: 1 -->
<svg width="2400pt" height="1075pt"
 viewBox="0.00 0.00 2400.17 1074.60" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1070.6)">
<title>UmlClassDiagram</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1070.6 2396.1672,-1070.6 2396.1672,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<polygon fill="#f2f2f2" stroke="#000000" points="0,-.5 0,-1066.1 1025.2698,-1066.1 1025.2698,-.5 0,-.5"/>
<text text-anchor="middle" x="512.6349" y="-1049.5" font-family="Times,serif" font-size="14.00" fill="#000000">Controller</text>
<polyline fill="none" stroke="#000000" points="0,-1041.3 1025.2698,-1041.3 "/>
<text text-anchor="start" x="8" y="-1024.7" font-family="Times,serif" font-size="14.00" fill="#000000">Internal:</text>
<text text-anchor="start" x="8" y="-1007.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;secInDay: uint256</text>
<text text-anchor="start" x="8" y="-991.1" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="8" y="-974.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;isShutDown: bool</text>
<text text-anchor="start" x="8" y="-957.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;weth: address</text>
<text text-anchor="start" x="8" y="-940.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;dai: address</text>
<text text-anchor="start" x="8" y="-923.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;ethDaiPool: address</text>
<text text-anchor="start" x="8" y="-907.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;powerPerpPool: address</text>
<text text-anchor="start" x="8" y="-890.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;uniswapPositionManager: address</text>
<text text-anchor="start" x="8" y="-873.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;shutDownEthPriceSnapshot: uint256</text>
<text text-anchor="start" x="8" y="-856.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;normalizationFactor: uint256</text>
<text text-anchor="start" x="8" y="-839.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;lastFundingUpdateTimestamp: uint256</text>
<text text-anchor="start" x="8" y="-823.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;isWethToken0: bool</text>
<text text-anchor="start" x="8" y="-806.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;vaults: mapping(uint256=&gt;VaultLib.Vault)</text>
<text text-anchor="start" x="8" y="-789.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;vaultNFT: IVaultManagerNFT</text>
<text text-anchor="start" x="8" y="-772.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;wPowerPerp: IWPowerPerp</text>
<text text-anchor="start" x="8" y="-755.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;oracle: IOracle</text>
<polyline fill="none" stroke="#000000" points="0,-747.7 1025.2698,-747.7 "/>
<text text-anchor="start" x="8" y="-731.1" font-family="Times,serif" font-size="14.00" fill="#000000">Internal:</text>
<text text-anchor="start" x="8" y="-714.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_canModifyVault(_vaultId: uint256, _account: address): bool</text>
<text text-anchor="start" x="8" y="-697.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_openVault(_recipient: address): (vaultId: uint256)</text>
<text text-anchor="start" x="8" y="-680.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_depositUniNFT(_account: address, _vaultId: uint256, _tokenId: uint256)</text>
<text text-anchor="start" x="8" y="-663.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_addEthCollateral(_vaultId: uint256, _amount: uint256)</text>
<text text-anchor="start" x="8" y="-647.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_withdrawUniNFT(_account: address, _vaultId: uint256)</text>
<text text-anchor="start" x="8" y="-630.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_withdrawCollateral(_account: address, _vaultId: uint256, _amount: uint256)</text>
<text text-anchor="start" x="8" y="-613.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_addShort(_account: address, _vaultId: uint256, _squeethAmount: uint256): (amountToMint: uint256)</text>
<text text-anchor="start" x="8" y="-596.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_removeShort(_account: address, _vaultId: uint256, _amount: uint256)</text>
<text text-anchor="start" x="8" y="-579.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_applyFunding()</text>
<text text-anchor="start" x="8" y="-563.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_checkUniNFT(_tokenId: uint256)</text>
<text text-anchor="start" x="8" y="-546.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_checkVault(_vaultId: uint256)</text>
<text text-anchor="start" x="8" y="-529.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_isVaultSafe(_vault: VaultLib.Vault): bool</text>
<text text-anchor="start" x="8" y="-512.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_getFairPeriodForOracle(_period: uint32): uint32</text>
<text text-anchor="start" x="8" y="-495.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_getMaxSafePeriod(): uint32</text>
<text text-anchor="start" x="8" y="-479.1" font-family="Times,serif" font-size="14.00" fill="#000000">External:</text>
<text text-anchor="start" x="8" y="-462.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;payable&gt;&gt; mint(_vaultId: uint256, _mintAmount: uint128, _nftTokenId: uint256): (uint256, _wSqueethMinted: uint256)</text>
<text text-anchor="start" x="8" y="-445.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;payable&gt;&gt; deposit(_vaultId: uint256)</text>
<text text-anchor="start" x="8" y="-428.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;payable&gt;&gt; withdraw(_vaultId: uint256, _amount: uint256)</text>
<text text-anchor="start" x="8" y="-411.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;payable&gt;&gt; donate()</text>
<text text-anchor="start" x="8" y="-395.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;depositUniNFT(_vaultId: uint256, _tokenId: uint256)</text>
<text text-anchor="start" x="8" y="-378.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;withdrawUniNFT(_vaultId: uint256)</text>
<text text-anchor="start" x="8" y="-361.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;burn(_vaultId: uint256, _amount: uint256, _withdrawAmount: uint256)</text>
<text text-anchor="start" x="8" y="-344.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;liquidate(_vaultId: uint256, _debtAmount: uint256)</text>
<text text-anchor="start" x="8" y="-327.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;getIndex(_period: uint32): uint256</text>
<text text-anchor="start" x="8" y="-311.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;getDenormalizedMark(_period: uint32): uint256</text>
<text text-anchor="start" x="8" y="-294.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;updateOperator(_vaultId: uint256, _operator: address)</text>
<text text-anchor="start" x="8" y="-277.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;shutDown()</text>
<text text-anchor="start" x="8" y="-260.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;redeemLong(_wPerpAmount: uint256)</text>
<text text-anchor="start" x="8" y="-243.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;redeemShort(_vaultId: uint256)</text>
<text text-anchor="start" x="8" y="-227.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;applyFunding()</text>
<text text-anchor="start" x="8" y="-210.3" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="8" y="-193.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; OpenVault(vaultId: uint256)</text>
<text text-anchor="start" x="8" y="-176.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; CloseVault(vaultId: uint256)</text>
<text text-anchor="start" x="8" y="-159.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; DepositCollateral(vaultId: uint256, amount: uint128, collateralId: uint128)</text>
<text text-anchor="start" x="8" y="-143.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; DepositUniNftCollateral(vaultId: uint256, tokenId: uint256)</text>
<text text-anchor="start" x="8" y="-126.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; WithdrawCollateral(vaultId: uint256, amount: uint256, collateralId: uint128)</text>
<text text-anchor="start" x="8" y="-109.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; WithdrawUniNftCollateral(vaultId: uint256, tokenId: uint256)</text>
<text text-anchor="start" x="8" y="-92.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; MintShort(amount: uint256, vaultId: uint256)</text>
<text text-anchor="start" x="8" y="-75.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; BurnShort(amount: uint256, vaultId: uint256)</text>
<text text-anchor="start" x="8" y="-59.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; UpdateOperator(vaultId: uint256, operator: address)</text>
<text text-anchor="start" x="8" y="-42.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;event&gt;&gt; Liquidate(vaultId: uint256, debtAmount: uint256, collateralToSell: uint256)</text>
<text text-anchor="start" x="8" y="-25.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;modifier&gt;&gt; notShutdown()</text>
<text text-anchor="start" x="8" y="-8.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;init(_oracle: address, _vaultNFT: address, _wPowerPerp: address, _weth: address, _dai: address, _ethDaiPool: address, _powerPerpPool: address, _uniPositionManager: address)</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<polygon fill="#f2f2f2" stroke="#000000" points="1042.8006,-420.5 1042.8006,-646.1 1778.4692,-646.1 1778.4692,-420.5 1042.8006,-420.5"/>
<text text-anchor="middle" x="1410.6349" y="-629.5" font-family="Times,serif" font-size="14.00" fill="#000000">Oracle</text>
<polyline fill="none" stroke="#000000" points="1042.8006,-621.3 1778.4692,-621.3 "/>
<text text-anchor="middle" x="1410.6349" y="-604.7" font-family="Times,serif" font-size="14.00" fill="#000000"> </text>
<polyline fill="none" stroke="#000000" points="1042.8006,-596.5 1778.4692,-596.5 "/>
<text text-anchor="start" x="1050.8006" y="-579.9" font-family="Times,serif" font-size="14.00" fill="#000000">Internal:</text>
<text text-anchor="start" x="1050.8006" y="-563.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_fetchTwapSafe(_pool: address, _base: address, _quote: address, _period: uint32, _amountIn: uint256): (amountOut: uint256)</text>
<text text-anchor="start" x="1050.8006" y="-546.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_fetchTwap(_pool: address, _base: address, _quote: address, _period: uint32, _amountIn: uint256): uint256</text>
<text text-anchor="start" x="1050.8006" y="-529.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;_getMaxPeriod(_pool: address): uint32</text>
<text text-anchor="start" x="1050.8006" y="-512.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;toUint128(y: uint256): (z: uint128)</text>
<text text-anchor="start" x="1050.8006" y="-495.9" font-family="Times,serif" font-size="14.00" fill="#000000">External:</text>
<text text-anchor="start" x="1050.8006" y="-479.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;getTwap(_pool: address, _base: address, _quote: address, _period: uint32): uint256</text>
<text text-anchor="start" x="1050.8006" y="-462.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;getTwapSafe(_pool: address, _base: address, _quote: address, _period: uint32): uint256</text>
<text text-anchor="start" x="1050.8006" y="-445.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;getMaxPeriod(_pool: address): uint32</text>
<text text-anchor="start" x="1050.8006" y="-428.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;getTimeWeightedAverageTickSafe(_pool: address, _period: uint32): (timeWeightedAverageTick: int24)</text>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<polygon fill="#f2f2f2" stroke="#000000" points="1796.4199,-445.7 1796.4199,-620.9 2102.8499,-620.9 2102.8499,-445.7 1796.4199,-445.7"/>
<text text-anchor="middle" x="1949.6349" y="-604.3" font-family="Times,serif" font-size="14.00" fill="#000000">VaultNFTManager</text>
<polyline fill="none" stroke="#000000" points="1796.4199,-596.1 2102.8499,-596.1 "/>
<text text-anchor="start" x="1804.4199" y="-579.5" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="1804.4199" y="-562.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;nextId: uint256</text>
<text text-anchor="start" x="1804.4199" y="-545.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;controller: address</text>
<polyline fill="none" stroke="#000000" points="1796.4199,-537.7 2102.8499,-537.7 "/>
<text text-anchor="start" x="1804.4199" y="-521.1" font-family="Times,serif" font-size="14.00" fill="#000000">External:</text>
<text text-anchor="start" x="1804.4199" y="-504.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;mintNFT(_recipient: address): (tokenId: uint256)</text>
<text text-anchor="start" x="1804.4199" y="-487.5" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="1804.4199" y="-470.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;modifier&gt;&gt; onlyController()</text>
<text text-anchor="start" x="1804.4199" y="-453.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;init(_controller: address)</text>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<polygon fill="#f2f2f2" stroke="#000000" points="2121.1026,-428.9 2121.1026,-637.7 2392.1672,-637.7 2392.1672,-428.9 2121.1026,-428.9"/>
<text text-anchor="middle" x="2256.6349" y="-621.1" font-family="Times,serif" font-size="14.00" fill="#000000">WSqueeth</text>
<polyline fill="none" stroke="#000000" points="2121.1026,-612.9 2392.1672,-612.9 "/>
<text text-anchor="start" x="2129.1026" y="-596.3" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="2129.1026" y="-579.5" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;controller: address</text>
<polyline fill="none" stroke="#000000" points="2121.1026,-571.3 2392.1672,-571.3 "/>
<text text-anchor="start" x="2129.1026" y="-554.7" font-family="Times,serif" font-size="14.00" fill="#000000">External:</text>
<text text-anchor="start" x="2129.1026" y="-537.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;init(_controller: address)</text>
<text text-anchor="start" x="2129.1026" y="-521.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;mint(_account: address, _amount: uint256)</text>
<text text-anchor="start" x="2129.1026" y="-504.3" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;burn(_account: address, _amount: uint256)</text>
<text text-anchor="start" x="2129.1026" y="-487.5" font-family="Times,serif" font-size="14.00" fill="#000000">Public:</text>
<text text-anchor="start" x="2129.1026" y="-470.7" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&lt;&lt;modifier&gt;&gt; onlyController()</text>
<text text-anchor="start" x="2129.1026" y="-453.9" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;constructor()</text>
<text text-anchor="start" x="2129.1026" y="-437.1" font-family="Times,serif" font-size="14.00" fill="#000000"> &#160;&#160;&#160;decimals(): uint8</text>
</g>
</g>
</svg>
